# Read the Docs configuration file
# See https://docs.readthedocs.io/en/stable/config-file/v2.html for details

version: 2

build:
  os: "ubuntu-lts-latest"
  tools:
    python: "miniforge3-latest"
  jobs:
    pre_create_environment:
      # Install uv
      - asdf plugin add uv
      - asdf install uv latest
      - asdf global uv latest
      # Install the rattler solver for conda
      - conda install -n base -c conda-forge -q -y conda-rattler-solver
      - conda config --set solver rattler
    install:
      # Reset the docs/environment.yaml to ensure a clean environment
      - git restore docs/environment.yaml
      # Use uv to install python packages on top of conda
      - uv pip install --editable . --group dev --prefix "${CONDA_ENVS_PATH}/${CONDA_DEFAULT_ENV}"
    post_install:
      # Show what is installed in the build environment
      - conda list

conda:
  environment: docs/environment.yaml

sphinx:
  builder: dirhtml
  configuration: docs/conf.py
